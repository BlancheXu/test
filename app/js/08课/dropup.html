<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
</head>
<body>

<script>
    window.onload = function() {
        document.body.innerHTML += '<div><input type="button" value="left" id="left"/><input type="button" value="right" id="right"/></div>';
        var aDiv = document.getElementsByTagName('div');
        for(var i=0;i<20;i++) {
            document.body.innerHTML += '<div style="position:relative;width:40px;height: 40px;background-color: red;margin-left: 5px;float: left;top:0px;margin-bottom: 5px;">'+i+'</div>';
        }

        function getStyle(obj,attr) {
            return obj.currentStyle?obj.currentStyle(attr):getComputedStyle(obj)[attr];
        }
        function move(obj,attr,dir,limit,fn) {
            clearInterval(obj.timer);
            var objLeft = parseInt(getStyle(obj,attr));
            dir = objLeft<limit?dir:-dir;
            obj.timer = setInterval(function() {
                objLeft += dir;
                if(dir<0 && objLeft < limit || dir>0 && objLeft > limit) {
                    objLeft = limit;
                }

                obj.style[attr] = objLeft + 'px';
                if(objLeft == limit) {
                    clearInterval(obj.timer);
                    fn && fn();
                }
            },200);

        }
        function upDown(arr,attr,dir,limit,fn) {
            var num = 0;
            var timer = null;
            clearInterval(timer);
           // dir = dir<limit?dir:-dir;
            timer = setInterval(function() {
                move(arr[num],attr,dir,limit,fn);
               //if(dir > 0) {
                    if(num > 19) {
                        num = 19;
                        clearInterval(timer);
                        fn && fn();
                    }
                    num++;

                /*}else {
                    if(num>19) {
                        num =19;
                        clearInterval(timer);
                        fn && fn();
                    }
                    num++;
                }*/
            },200);
        }
        var up = document.getElementById('left');
        var down = document.getElementById('right');

        down.onclick = function() {
            upDown(aDiv,'top',30,50);
        }
        up.onclick = function() {
            upDown(aDiv,'top',30,0);
        }
        document.onclick = function () {
            upDown(aDiv,'top',30,50, function () {
                document.onclick = function() {
                    upDown(aDiv,'top',30,0);
                }
            });
        }

    }

</script>
</body>
</html>